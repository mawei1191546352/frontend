### âœï¸ Tangxt â³ 2021-10-08 ğŸ·ï¸ CSS

# æ·±å…¥ç†è§£ CSSï¼šfont metricsï¼ˆå­—ä½“åº¦é‡ï¼‰ã€line-height å’Œ vertical-align

> åŸæ–‡ï¼š[Deep dive CSS: font metrics, line-height and vertical-align - Vincent De Oliveira](https://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align)

`Line-height` å’Œ `vertical-align` éƒ½æ˜¯ç®€å•çš„ CSS å±æ€§ã€‚å®ƒä»¬æ˜¯å¦‚æ­¤çš„ç®€å•ï¼Œä»¥è‡³äºæˆ‘ä»¬å¤§å¤šæ•°äººéƒ½ç¡®ä¿¡èƒ½å¤Ÿå®Œå…¨ç†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚ä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚å®ƒä»¬çœŸçš„å¾ˆå¤æ‚ï¼Œä¹Ÿè®¸æ˜¯æœ€éš¾çš„ï¼Œå› ä¸º**å®ƒä»¬åœ¨åˆ›å»ºä¸€ä¸ªé²œä¸ºäººçŸ¥çš„ CSS ç‰¹æ€§ï¼šå†…è”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆinline formatting contextï¼‰è¿‡ç¨‹ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚**

ä¾‹å¦‚ï¼Œå¯ä»¥å°† `line-height` çš„å€¼è®¾ç½®ä¸ºé•¿åº¦ï¼ˆlengthï¼Œå¦‚`16px`ï¼‰ æˆ–æ— å•ä½å€¼ `1`ï¼ˆä¸ç®¡ä½ é€‰æ‹©ä»€ä¹ˆï¼Œè¿™éƒ½ä¸æ˜¯é‡ç‚¹ï¼‰ï¼Œä½†å®ƒçš„é»˜è®¤å€¼æ˜¯ `normal`ã€‚ç„¶è€Œï¼Œä»€ä¹ˆæ˜¯`normal`å‘¢ï¼Ÿæˆ‘ä»¬ç»å¸¸è¯»åˆ°å®ƒæ˜¯ï¼ˆæˆ–è€…åº”è¯¥æ˜¯ï¼‰`1`ï¼Œæˆ–è€…å¯èƒ½æ˜¯ `1.2`ï¼Œç”šè‡³è¿ [CSS è§„èŒƒåœ¨è¿™ä¸€ç‚¹ä¸Šä¹Ÿä¸æ¸…æ¥š](https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height)ã€‚æˆ‘ä»¬çŸ¥é“æ— å•ä½çš„`line-height`æ˜¯ç›¸å¯¹äº`font-size`çš„ï¼Œä½†é—®é¢˜æ˜¯ `font-size:100px` åœ¨ä¸åŒçš„å­—ä½“æ—ï¼ˆfont-familiesï¼‰ä¸­å…¶è¡¨ç°æ˜¯æœ‰æ‰€ä¸åŒçš„ï¼Œæ‰€ä»¥`line-height`æ€»æ˜¯ç›¸åŒè¿˜æ˜¯ä¸åŒï¼ŸçœŸçš„åœ¨`1`åˆ°`1.2`ä¹‹é—´å—ï¼Ÿè¿˜æœ‰ï¼Œ`vertical-align`å®ƒå¯¹`line-height`åˆæœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ

æ·±å…¥ç ”ç©¶ä¸€ä¸ªä¸é‚£ä¹ˆç®€å•çš„ CSS æœºåˆ¶â€¦â€¦

## Letâ€™s talk about `font-size` first

çœ‹çœ‹è¿™ä¸ªç®€å•çš„ HTML ä»£ç ï¼Œä¸€ä¸ª`<p>`åŒ…å« 3 ä¸ª`<span>`ï¼Œå¹¶ä¸”è¿™æ¯ä¸ª`<span>`éƒ½æœ‰ä¸åŒçš„`font-family`ï¼š

``` html
<p>
  <span class="a">Ba</span>
  <span class="b">Ba</span>
  <span class="c">Ba</span>
</p>
```

``` css
p  { font-size: 100px }
.a { font-family: Helvetica }
.b { font-family: Gruppo    }
.c { font-family: Catamaran }
```

æˆ‘ä»¬ä½¿ç”¨äº†ç›¸åŒçš„`font-size`ï¼Œä¸åŒçš„å­—ä½“ç§ç±»ï¼ˆfont-familiesï¼Œå­—ä½“æ—ã€å­—ä½“ç³»åˆ—ï¼‰ï¼Œå¾—åˆ°äº†ä¸åŒé«˜åº¦çš„å…ƒç´ ï¼š

![Different font-families, same font-size, give various heights](assets/img/2021-10-08-10-33-08.png)

> 1. ä¸åŒçš„å­—ä½“ç³»åˆ—ï¼Œç›¸åŒçš„å­—ä½“å¤§å°ï¼Œå¾—åˆ°äº†ä¸åŒçš„é«˜åº¦

å³ä½¿æˆ‘ä»¬æ„è¯†åˆ°äº†è¿™ç§è¡Œä¸ºï¼Œä½†ä¸ºä»€ä¹ˆ `font-size: 100px` ä¸èƒ½åˆ›å»ºé«˜åº¦ä¸º `100px` çš„å…ƒç´ å‘¢ï¼Ÿæˆ‘æµ‹é‡è¿™äº›å…ƒç´ å¹¶å‘ç°äº†è¿™äº›å€¼ï¼šHelvetica: 115pxï¼ŒGruppo: 97px å’Œ Catamaran: 164px

![Elements with font-size: 100px have height that varies from 97px to 164px](assets/img/2021-10-08-10-38-39.png)

> 2. `font-size: 100px`çš„å…ƒç´ ï¼Œå…¶é«˜åº¦ä»`97px`åˆ°`164px`ä¸ç­‰â€¦â€¦

è™½ç„¶ä¸€å¼€å§‹çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œä½†å®Œå…¨åœ¨æ„æ–™ä¹‹ä¸­ã€‚åŸå› åœ¨äºå­—ä½“æœ¬èº«ã€‚ä»¥ä¸‹æ˜¯å®ƒçš„å·¥ä½œåŸç†ï¼š

- å­—ä½“å®šä¹‰äº†å®ƒçš„ [em-square](http://designwithfontforge.com/en-US/The_EM_Square.html)ï¼ˆor UPM, units per emï¼‰ï¼Œä¸€ç§ï¼ˆæŠ½è±¡çš„æ–¹å½¢ï¼‰å®¹å™¨ï¼Œæ¯ä¸ªå­—ç¬¦å°†åœ¨å…¶ä¸­ç»˜åˆ¶ã€‚è¯¥ square ä½¿ç”¨ç›¸å¯¹å•ä½ï¼ˆrelative unitsï¼‰ï¼Œé€šå¸¸è®¾ç½®ä¸º 1000 ä¸ªå•ä½ï¼ˆOpenType å­—ä½“æƒ…å†µï¼‰ï¼Œå½“ç„¶ï¼Œå®ƒï¼ˆTrueType å­—ä½“æƒ…å†µï¼Œ2 çš„å‡ æ¬¡æ–¹ï¼‰ä¹Ÿå¯ä»¥æ˜¯ 1024ã€2048 æˆ–å…¶ä»–ã€‚
  
   ![ç›¸å¯¹å•ä½](assets/img/2021-10-08-12-07-45.png)
  
- åŸºäºå­—ä½“çš„ç›¸å¯¹å•ä½æ¥è®¾ç½®å­—ä½“çš„åº¦é‡ï¼ˆascender, descender, capital height, x-height, etc.ï¼‰ã€‚è¯·æ³¨æ„ï¼ŒæŸäº›å€¼å¯èƒ½ä¼šæº¢å‡º em-square ä¹‹å¤–ã€‚
  
  ![å­—ä½“åº¦é‡](assets/img/2021-10-08-12-09-03.png)

- åœ¨æµè§ˆå™¨ä¸­ï¼Œç›¸å¯¹å•ä½ä¼šç¼©æ”¾ä»¥é€‚åˆæ‰€éœ€çš„å­—ä½“å¤§å° -> ä¸€èˆ¬ç¼©å° 10 å€

è®©æˆ‘ä»¬ä½¿ç”¨ Catamaran å­—ä½“å¹¶åœ¨ [FontForge](https://fontforge.github.io/en-US/) ä¸­æ‰“å¼€å®ƒæ¥è·å¾—å®ƒçš„åº¦é‡ï¼š

- em-square æ˜¯ 1000
- ascender æ˜¯ 1100ï¼Œdescender æ˜¯ 540ã€‚åœ¨è¿è¡Œäº†ä¸€äº›æµ‹è¯•ä¹‹åï¼Œä¼¼ä¹åœ¨ Mac OS ä¸Šçš„æµè§ˆå™¨ä½¿ç”¨çš„æ˜¯ HHead Ascent/Descent å€¼ï¼Œè€Œåœ¨ Windows ä¸Šçš„æµè§ˆå™¨åˆ™ä½¿ç”¨ Win Ascent/Descent å€¼ï¼ˆè¿™äº›å€¼å¯èƒ½ä¸åŒï¼ï¼‰ã€‚æˆ‘ä»¬è¿˜æ³¨æ„åˆ° Capital Height æ˜¯ 680ï¼ŒX height æ˜¯ 485

![å­—ä½“åº¦é‡](assets/img/2021-10-08-12-22-06.png)

> 3. ä½¿ç”¨ FontForge å¾—åˆ°è¿™ç§å­—ä½“çš„å­—ä½“åº¦é‡å€¼

![ttf](assets/img/2021-10-08-12-25-23.png)

> è¿™ä¸ª [Catamaran.ttf](http://xiazaiziti.com/138180.html) æ˜¯ TrueTypeFontï¼Œç„¶è€Œæ˜¯ 1000 em-squareï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯æ˜¯ 2 çš„ x æ¬¡æ–¹â€¦â€¦å½“ç„¶ï¼Œè¿™éƒ½æ˜¯é€šå¸¸æƒ¯ä¾‹ï¼ -> å¥½åƒ`.ttf`ä¹Ÿå¯ä»¥æ˜¯ OpenType å­—ä½“å®šä¹‰çš„åç¼€ï¼ï¼ˆOpenType ä¹Ÿå« Type 2 å­—ä½“ï¼Œæ˜¯ç”± Microsoft å’Œ Adobe å…¬å¸å¼€å‘çš„å¦å¤–ä¸€ç§å­—ä½“æ ¼å¼ã€‚OpenType å­—ä½“æ¯” TrueType æ›´ä¸ºå¼ºå¤§ï¼‰

è¿™æ„å‘³ç€ Catamaran å­—ä½“åœ¨ 1000 ä¸ªå•ä½çš„ em-square ä¸­ä½¿ç”¨ 1100 + 540 ä¸ªå•ä½ï¼Œå½“è®¾ç½®`font-size: 100px`æ—¶ï¼ŒCatamaran å­—ä½“çš„é«˜åº¦ä¸º 164pxã€‚**è¿™ä¸ªè®¡ç®—å‡ºçš„é«˜åº¦å®šä¹‰äº†å…ƒç´ çš„ content-areaï¼ˆå†…å®¹åŒºåŸŸï¼‰**ï¼Œæˆ‘å°†åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ä½¿ç”¨è¿™ä¸ªæœ¯è¯­ã€‚ä½ å¯ä»¥å°†å†…å®¹åŒºåŸŸè§†ä¸ºåº”ç”¨`background`å±æ€§çš„åŒºåŸŸï¼ˆä¸¥æ ¼æ¥è¯´è¿™ä¸æ˜¯è¿™æ ·çš„ -> æ­£ç¡®æ¥è¯´æ˜¯`border+padding+content`ï¼Œä½†æˆ‘ä»¬ä¸åŠ `border+padding`ï¼Œé‚£å°±å¯ä»¥è¿™æ ·è®¤ä¸ºäº†ï¼‰ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥é¢„çŸ¥åˆ°ï¼Œå¤§å†™å­—æ¯ä¸º 68px é«˜ (680 ä¸ªå•ä½ï¼‰ï¼Œå°å†™å­—æ¯ (x-height) ä¸º 49px é«˜ (485 ä¸ªå•ä½ï¼‰ã€‚æ‰€ä»¥ï¼Œ`1ex = 49px`ï¼Œ`1em = 100px`ï¼Œè€Œä¸æ˜¯ 164pxï¼ˆè°¢å¤©è°¢åœ°ï¼Œ`em` æ˜¯åŸºäº font-sizeï¼Œè€Œä¸æ˜¯è®¡ç®—å‡ºæ¥çš„é«˜åº¦ï¼‰

![è®¡ç®—å…¶ä»–åº¦é‡](assets/img/2021-10-08-13-11-21.png)

> 4. Catamaran å­—ä½“ï¼šUPM â€”Units Per Emâ€” and pixels equivalent using font-sizeï¼š100pxï¼ˆä½¿ç”¨å’Œ`font-size:100px`ç­‰æ•ˆçš„åƒç´ ï¼‰

åœ¨ç»§ç»­æ·±å…¥è®¨è®ºä¹‹å‰ï¼Œå…ˆç®€è¦è¯´æ˜ä¸€ä¸‹è¿™ä¼šæ¶‰åŠçš„å†…å®¹ã€‚å½“ä¸€ä¸ª`<p>`å…ƒç´ åœ¨å±å¹•ä¸Šå‘ˆç°æ—¶ï¼Œæ ¹æ®å®ƒçš„å®½åº¦ï¼Œå®ƒå¯ä»¥ç”±å¤šè¡Œç»„æˆã€‚æ¯ä¸€è¡Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªå†…è”å…ƒç´  (HTML æ ‡ç­¾æˆ–ç”¨äºæ–‡æœ¬å†…å®¹çš„åŒ¿åå†…è”å…ƒç´ ï¼‰ç»„æˆï¼Œè¿™æ¯ä¸€è¡Œè¢«ç§°ä¹‹ä¸ºã€Œline-boxã€ã€‚**line-box çš„é«˜åº¦æ˜¯åŸºäºå…¶æ‰€æœ‰å­å…ƒç´ çš„é«˜åº¦è®¡ç®—è€Œæ¥çš„**ã€‚å› æ­¤ï¼Œæµè§ˆå™¨ä¼šè®¡ç®—è¿™ä¸€è¡Œé‡Œæ¯ä¸ªå†…è”å…ƒç´ çš„é«˜åº¦ï¼Œä»è€Œè®¡ç®—å‡º line-box çš„é«˜åº¦ï¼ˆä»å…¶å­å…ƒç´ çš„æœ€é«˜ç‚¹åˆ°å…¶å­å…ƒç´ çš„æœ€ä½ç‚¹ï¼‰ã€‚æ‰€ä»¥ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ª line-box æ€»æ˜¯æœ‰è¶³å¤Ÿçš„é«˜åº¦æ¥åŒ…å«å®ƒçš„æ‰€æœ‰å­å…ƒç´ ã€‚

> æ¯ä¸ª HTML å…ƒç´ å®é™…ä¸Šæ˜¯ä¸€å † line-boxexï¼ˆå°±åƒä¸€æ‘ä¹¦ä¸€æ ·ï¼‰ã€‚å¦‚æœçŸ¥é“æ¯ä¸ª line-box çš„é«˜åº¦ï¼Œé‚£ä½ å°±å¯ä»¥çŸ¥é“ä¸€ä¸ªå…ƒç´ çš„é«˜åº¦ã€‚

![ä¸€å † line-box](assets/img/2021-10-08-13-54-59.png)

å¦‚æœæˆ‘ä»¬åƒè¿™æ ·æ›´æ–°å…ˆå‰çš„ HTML ä»£ç ï¼š

``` html
<p>
  Good design will be better.
  <span class="a">Ba</span>
  <span class="b">Ba</span>
  <span class="c">Ba</span>
  We get to make a consequence.
</p>
```

å®ƒå°†ä¼šç”Ÿæˆ 3 ä¸ª line-boxï¼š

- ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªåˆ†åˆ«åŒ…å«ä¸€ä¸ªåŒ¿åå†…è”å…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯æ–‡æœ¬å†…å®¹ï¼‰
- ç¬¬äºŒä¸ªåŒ…å«ä¸¤ä¸ªåŒ¿åå†…è”å…ƒç´ ä»¥åŠ 3 ä¸ª`<span>`

![line-box](assets/img/2021-10-08-14-02-58.png)

> ä¸€ä¸ª`<p>`ï¼ˆé»‘è‰²è¾¹æ¡†ï¼‰ç”±å¤šä¸ª line-boxï¼ˆç™½è‰²è¾¹æ¡†ï¼‰ç»„æˆï¼Œå…¶ä¸­ line-box åŒ…å«äº†å†…è”å…ƒç´ ï¼ˆå®çº¿`solid`è¾¹æ¡†ï¼‰åŒ¿åå†…è”å…ƒç´ ï¼ˆè™šçº¿ `dashed` è¾¹æ¡†ï¼‰

æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œç¬¬äºŒä¸ª line-box è¦æ¯”å…¶ä»– line-box é«˜ï¼Œå› ä¸ºè¿™æ˜¯æ ¹æ®å…¶å­å…ƒç´ çš„å†…å®¹åŒºåŸŸï¼ˆcontent-areaï¼‰è€Œè®¡ç®—å¾—æ¥çš„é«˜åº¦ï¼Œæ›´å…·ä½“åœ°è¯´ï¼Œæ˜¯ä½¿é‚£ä¸ª Catamaran å­—ä½“çš„ `span`ã€‚

**å›°éš¾çš„æ˜¯ line-box åˆ›å»ºéƒ¨åˆ†æˆ‘ä»¬ä¸èƒ½çœŸæ­£çœ‹åˆ°å®ƒï¼Œä¹Ÿæ— æ³•ç”¨ CSS æ§åˆ¶å®ƒ**ã€‚å³ä½¿æˆ‘ä»¬ç”¨ `::first-line` ç»™ç¬¬ä¸€è¡ŒåŠ ä¸ŠèƒŒæ™¯è‰²ä¹Ÿæ— æ³•ç›´æ¥åœ¨è§†è§‰ä¸Šçœ‹åˆ°ç¬¬ä¸€ä¸ª line-box çš„é«˜åº¦ã€‚

## line-height: to the problems and beyond

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»‹ç»äº†ä¸¤ä¸ªæ¦‚å¿µï¼šcontent-area å’Œ line-boxã€‚å¦‚æœä½ è¯»å¾—å¾ˆå¥½ï¼Œä½ ä¼šå‘ç°æˆ‘å‘Šè¯‰äº†ä½ ä¸€ä¸ª line-box çš„é«˜åº¦æ˜¯æ ¹æ®å®ƒçš„å­é«˜åº¦è®¡ç®—å‡ºæ¥çš„ï¼Œå¹¶æ²¡æœ‰è¯´æ˜¯å®ƒçš„å­å…ƒç´ çš„ content-area çš„é«˜åº¦ã€‚è¿™æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚

æ¥ä¸‹æ¥è¯´å¥å¬èµ·æ¥å¾ˆå¥‡æ€ªçš„è¯ï¼š**ä¸€ä¸ªå†…è”å…ƒç´ æœ‰ä¸¤ä¸ªä¸åŒçš„é«˜åº¦ï¼šcontent-area é«˜åº¦å’Œ virtual-area ï¼ˆå®é™…åŒºåŸŸï¼Ÿï¼‰é«˜åº¦**ï¼ˆvirtual-area æ˜¯æˆ‘è‡ªå·±å‘æ˜çš„æœ¯è¯­ï¼Œå› ä¸ºè¯¥é«˜åº¦å¯¹æˆ‘ä»¬æ˜¯ä¸å¯è§çš„ï¼Œä½ åœ¨è§„èŒƒä¸­æ˜¯æ‰¾ä¸åˆ°å…³äºè¿™ä¸ªã€Œæœ¯è¯­ã€ä»»ä½•ç›¸å…³çš„å†…å®¹ï¼‰ã€‚

* content-area çš„é«˜åº¦æ˜¯ç”±å­—ä½“åº¦é‡å®šä¹‰çš„ï¼ˆè§ä¸Šæ–‡ï¼‰
* **vitual-area çš„é«˜åº¦å°±æ˜¯ `line-height`**ï¼Œè¿™ä¸ªé«˜åº¦**ç”¨äºè®¡ç®— line-box çš„é«˜åº¦**

![vitual-area é«˜åº¦](assets/img/2021-10-08-14-51-35.png)

> 6. å†…è”å…ƒç´ æœ‰ä¸¤ä¸ªä¸åŒçš„é«˜åº¦

ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™å°±æ‰“ç ´äº†ä¸€ä¸ªé•¿ä¹…æµè¡Œçš„è§‚ç‚¹ï¼Œå³`line-height`æ˜¯ä¸¤ä¸ª baseline ä¹‹é—´çš„è·ç¦»ã€‚åœ¨ CSS ä¸­ï¼Œå®ƒå¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚ï¼ˆåœ¨å…¶ä»–ç¼–è¾‘è½¯ä»¶ä¸­ï¼Œå®ƒå¯èƒ½æ˜¯åŸºçº¿ä¹‹é—´çš„è·ç¦»ã€‚åœ¨ Word æˆ–è€… Photoshop ä¸­ï¼Œæƒ…å†µå°±æ˜¯è¿™æ ·ã€‚è¿™ä¸»è¦çš„åŒºåˆ«åœ¨äºç¬¬ä¸€è¡Œä¹Ÿå—åˆ° CSS çš„å½±å“ï¼‰

![è¡Œé«˜æŒ‡çš„æ˜¯](assets/img/2021-10-08-14-57-08.png)

> 7. åœ¨ CSS ä¸­ï¼Œline-height ä¸æ˜¯ä¸¤ä¸ªåŸºçº¿ä¹‹é—´çš„è·ç¦»

è®¡ç®—å‡º virtual-area å’Œ content-area ä¹‹é—´çš„é«˜åº¦å·®å¼‚è¢«å«åšã€Œleadingã€ã€‚leading çš„ä¸€åŠä¼šè¢«åŠ åˆ° content-area é¡¶éƒ¨ï¼Œè€Œå¦ä¸€åŠåˆ™ä¼šè¢«åŠ åˆ°åº•éƒ¨ã€‚**å› æ­¤ content-area æ€»æ˜¯å¤„äº virtual-area çš„ä¸­é—´**ã€‚

æ ¹æ®å…¶è®¡ç®—å€¼ï¼Œè®¡ç®—å‡ºæ¥çš„ `line-height`ï¼ˆä¹Ÿå°±æ˜¯ virtual-area çš„é«˜åº¦ï¼‰å¯ä»¥ç­‰äºã€å¤§äºæˆ–å°äº content-areaã€‚åœ¨ virtual-area å°äº content-area çš„æƒ…å†µä¸‹ï¼Œleading å°±æ˜¯è´Ÿçš„ï¼Œå› æ­¤ line-box åœ¨è§†è§‰ä¸Šå°±æ¯”å†…å®¹ï¼ˆå®ƒçš„å­å…ƒç´ ä»¬ï¼‰è¿˜çŸ®äº†ã€‚

è¿˜æœ‰ä¸€äº›å…¶ä»–ç§ç±»çš„å†…è”å…ƒç´ ï¼š

* å¯æ›¿æ¢çš„å†…è”å…ƒç´ ï¼ˆå¦‚ `<img>`, `<input>`, `<svg>`ç­‰ï¼‰
* `inline-block` å…ƒç´ ï¼Œä»¥åŠæ‰€æœ‰ `display` å€¼ä»¥ `inline-` å¼€å¤´çš„å…ƒç´ ï¼ˆç®€ç§°`inline-*`å…ƒç´ ï¼‰ï¼Œå¦‚ `inline-table`ã€`inline-flex`ç­‰
* å¤„äºæŸç§ç‰¹æ®Šæ ¼å¼åŒ–ä¸Šä¸‹æ–‡çš„å†…è”å…ƒç´ ï¼Œä¾‹å¦‚ flexbox å…ƒç´ ä¸­çš„å­å…ƒç´ éƒ½å¤„äº flex formatting contextï¼ˆå¼¹æ€§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼‰ä¸­ï¼Œè¿™äº›å­å…ƒç´ ï¼ˆflex itemï¼‰çš„ `display` å€¼éƒ½æ˜¯ã€Œblockifiedã€

å¯¹äºè¿™äº›ç‰¹å®šçš„å†…è”å…ƒç´ ï¼Œå…¶é«˜åº¦æ˜¯åŸºäº `height`ã€`margin` å’Œ `border` å±æ€§ï¼ˆè¯‘è€…æ³¨ï¼šå¥½åƒæ¼äº† `padding`ï¼Œåˆæˆ–è€…æ˜¯`height+padding+border`ï¼Œæ²¡æœ‰`margin`ï¼Œå› ä¸ºå†…è”å…ƒç´ ä¸Šä¸‹`margin`æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼‰æ¥è®¡ç®—çš„ã€‚å¦‚æœä½ å°†å…¶ `height` è®¾ç½®ä¸º `auto` çš„è¯ï¼Œé‚£ä¹ˆå…¶é«˜åº¦çš„å–å€¼å°±æ˜¯ `line-height`ï¼Œå…¶ content-area çš„å–å€¼ä¸¥æ ¼ç­‰äº`line-height`ã€‚

![height auto](assets/img/2021-10-08-16-07-05.png)

> 8. Inline replaced elements, inline-block/inline-* and blocksified inline elements çš„ content-area ç­‰äºå®ƒä»¬çš„ height æˆ–è€… line-height

æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬ç›®å‰ä¾ç„¶æ²¡æœ‰è§£é‡Š `line-height` æ˜¯`normal`çš„æ„æ€ã€‚è¦è§£ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åˆå¾—å›åˆ° content-area é«˜åº¦çš„è®¡ç®—äº†ï¼Œé—®é¢˜çš„ç­”æ¡ˆå°±åœ¨å­—ä½“åº¦é‡é‡Œé¢ã€‚

è®©æˆ‘ä»¬å›åˆ° FontForgeï¼ŒCatamaran çš„ em-square é«˜åº¦æ˜¯ 1000ï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜çœ‹åˆ°å¾ˆå¤šå…¶ä»–çš„ ascender/descender å€¼ï¼š

![å­—ä½“åº¦é‡](assets/img/2021-10-08-12-22-06.png)

* å¸¸è§„çš„ï¼ˆgeneralsï¼‰Ascent/Descentï¼šascender æ˜¯ 770ï¼Œdescender æ˜¯ 230ï¼Œç”¨äºæ¸²æŸ“å­—ç¬¦ï¼ˆcharacter drawingsï¼‰ã€‚ï¼ˆtable â€œOS/2â€ï¼‰
* è§„æ ¼ï¼ˆmetricsï¼‰Ascent/Descentï¼šascender æ˜¯ 1100ï¼Œdescender æ˜¯ 540ã€‚ç”¨äºè®¡ç®— content-area çš„é«˜åº¦ã€‚ï¼ˆtable â€œhheaâ€ and table â€œOS/2â€ï¼‰
* è§„æ ¼ï¼ˆmetricï¼‰Line Gapï¼ˆåº¦é‡çº¿çš„é—´è·ï¼‰ï¼šç”¨äºè®¡ç®— `line-height: normal`ï¼Œé€šå¸¸ï¼Œå°†è¿™ä¸ªå€¼æ·»åŠ åˆ° Ascent/Descent metricsï¼ï¼ˆtable â€œhheaâ€ï¼‰

åœ¨åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œ Catamaran è¿™æ¬¾å­—ä½“å®šä¹‰äº† 0 ä¸ªå•ä½çš„ line gapï¼Œå› æ­¤`line-height: normal`çš„ç»“æœå°±ç­‰äº content-area çš„é«˜åº¦ï¼Œä¹Ÿå°±æ˜¯`1640`ä¸ªå•ä½æˆ–`1.64`ã€‚

ä¸ºäº†å¯¹æ¯”ï¼Œæˆ‘ä»¬å†çœ‹çœ‹ Arial å­—ä½“ï¼Œå®ƒæè¿°çš„ em-square æ˜¯ 2048ï¼Œascender æ˜¯ 1854ï¼Œdescender æ˜¯ 434ï¼Œline gap æ˜¯ 67ã€‚è¿™æ„å‘³ç€ï¼Œå½“`font-size: 100px` æ—¶ï¼Œ

* å…¶ content-area çš„é«˜åº¦å°±æ˜¯ `(100/2048)*(1854+434) = 111.72`ï¼Œçº¦ä¸º 112pxï¼ˆ1117 ä¸ªå•ä½ï¼‰ï¼›
* å…¶ `line-height: normal` çš„ç»“æœå°±æ˜¯ `(100/2048)*(67+1854+434)` çº¦ä¸º 115pxï¼ˆ1150 ä¸ªå•ä½æˆ– 1.15ï¼‰ã€‚

æ‰€æœ‰è¿™äº›åº¦é‡éƒ½æ˜¯ç‰¹å®šäºå­—ä½“çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™éƒ½æ˜¯ç”±å­—ä½“è®¾è®¡å¸ˆè®¾ç½®çš„ã€‚

è¿™ä¹ˆçœ‹æ¥ï¼Œ**`line-height:1` å¾ˆæ˜æ˜¾å°±æ˜¯ä¸€ä¸ªå¾ˆç³Ÿç³•çš„å®è·µ**ã€‚ä½ è¿˜è®°å¾—å—ï¼Œå½“ `line-height` çš„å€¼æ˜¯ä¸€ä¸ªæ•°å­—æ—¶ï¼Œå…¶å®å°±æ˜¯ç›¸å¯¹ `font-size` çš„å€æ•°ï¼Œè€Œä¸æ˜¯ç›¸å¯¹äº content-areaã€‚æ‰€ä»¥ `line-height:1` å¾ˆæœ‰å¯èƒ½ä½¿å¾— virtual-area æ¯” content-area çŸ®ï¼Œä»è€Œå¼•å‘å¾ˆå¤šå…¶ä»–çš„é—®é¢˜ã€‚

![è¡Œé«˜æ¯”å†…å®¹åŒºè¦çŸ®](assets/img/2021-10-08-18-00-16.png)

> ä½¿ç”¨ `line-height: 1` å¯ä»¥åˆ›å»ºä¸€ä¸ªå°äº context-area çš„ line-box

ç„¶è€Œï¼Œä¸ä»…ä»…æ˜¯ `line-height:1` æœ‰é—®é¢˜ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨æˆ‘ç”µè„‘ä¸Šå®‰è£…çš„ 1117 æ¬¾å­—ä½“ï¼ˆæ˜¯çš„ï¼Œ[æˆ‘å®‰è£…äº†æ¥è‡ª Google Web Fonts é‡Œè¾¹çš„æ‰€æœ‰å­—ä½“](https://github.com/qrpike/Web-Font-Load)ï¼‰ï¼Œå…¶ä¸­ 1059 æ¬¾å­—ä½“ï¼Œå å…¨éƒ¨å­—ä½“çš„`95%`å·¦å³ï¼Œè®¡ç®—çš„`line-height` æ¯” 1 å¤§ï¼Œæœ€ä½çš„æœ‰ 0.618ï¼Œæœ€é«˜çš„æœ‰ 3.378ã€‚ä½ æ²¡çœ‹é”™ï¼Œæ˜¯ 3.378ï¼

å…³äº line-box è®¡ç®—çš„å°ç»†èŠ‚ï¼š

* å¯¹äºå†…è”å…ƒç´ ï¼Œ`padding` å’Œ `border` ä¼šå¢å¤§ background åŒºåŸŸï¼Œä½†æ˜¯ä¸ä¼šå¢å¤§ content-area çš„é«˜åº¦ï¼ˆä¸æ˜¯ line-box çš„é«˜åº¦ï¼‰ã€‚å› æ­¤ï¼Œä½ åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„ä¸ä¸€å®šå°±æ˜¯å†…å®¹åŒºåŸŸã€‚`margin-top` å’Œ `margin-bottom` å¯¹å†…è”å…ƒç´ æ²¡æœ‰ä½œç”¨ã€‚
* å¯¹äºå¯æ›¿æ¢å†…è”å…ƒç´ ï¼ˆreplaced inline elementsï¼‰,`inline-block` å…ƒç´ å’Œ blockified å†…è”å…ƒç´ ï¼š`padding`ã€`margin` å’Œ `border` éƒ½ä¼šå¢å¤§ `height`ï¼ˆè¯‘è€…æ³¨ï¼šæ³¨æ„ `margin`ï¼‰ï¼Œæ‰€ä»¥ content-area å’Œ line-box çš„é«˜åº¦ä¹Ÿä¼šæœ‰æ‰€å¢åŠ 

## vertical-align: one property to rule them all

> ä¸€ä¸ªå±æ€§æ§åˆ¶ä¸€åˆ‡

æˆ‘è¿˜æ²¡æè¿‡ `vertical-align` å±æ€§ï¼Œå°½ç®¡å®ƒæ˜¯è®¡ç®— line-box é«˜åº¦çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥è¯´ `vertical-align` å¯èƒ½åœ¨å†…è”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆIFCï¼‰ä¸­èµ·ä¸»å¯¼ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ IFC ä¸­æœ€é‡è¦çš„å±æ€§ã€‚

å®ƒçš„é»˜è®¤å€¼æ˜¯ `baseline`ã€‚è¿˜è®°å¾—å­—ä½“åº¦é‡é‡Œçš„ ascender å’Œ descender å—ï¼Ÿè¿™äº›å€¼å†³å®šäº† baseline çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æ¯”ä¾‹ã€‚å¾ˆå°‘æœ‰å­—ä½“çš„ ascender å’Œ descender ä¹‹é—´çš„æ¯”ä¾‹æ˜¯ä¸€æ¯”ä¸€ï¼ˆ`50/50`ï¼‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°ä¸€äº›æ„æƒ³ä¸åˆ°çš„ç°è±¡ï¼Œä¾‹å¦‚ä½¿ç”¨å…„å¼Ÿå…ƒç´ 

ä»è¿™æ®µä»£ç å¼€å§‹ï¼š

``` html
<p>
  <span>Ba</span> 
  <span>Ba</span>
</p>
```

``` css
p {
  font-family: Catamaran;
  font-size: 100px;
  line-height: 200px;
}
```

ä¸€ä¸ª `<p>` æ ‡ç­¾å†…æœ‰ä¸¤ä¸ª`<span>` æ ‡ç­¾ï¼Œ`<span>` ç»§æ‰¿äº† `font-family`ã€`font-size` å’Œ å›ºå®šçš„ `200px` `line-height`ã€‚è¿™æ—¶ä¸¤ä¸ª span çš„ baseline æ˜¯ç­‰é«˜çš„ï¼Œline-box çš„é«˜åº¦å°±æ˜¯ span çš„ `line-height`ã€‚

![è¡Œé«˜](assets/img/2021-10-08-18-33-35.png)

> 10. ç›¸åŒçš„`font`å€¼ï¼Œç›¸åŒçš„ baselineï¼Œä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆæ­£å¸¸

å¦‚æœç¬¬äºŒä¸ª `span` çš„ `font-size` æ›´å°äº†å‘¢ï¼Ÿ

``` css
span:last-child {
  font-size: 50px;
}
```

è¿™å¬èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†**é»˜è®¤çš„ baseline å¯¹é½å¯èƒ½ä¼šå¯¼è‡´ line-box çš„é«˜åº¦å˜é«˜äº†**ï¼å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æç¤ºä½ ä¸€ä¸‹ï¼Œline-box çš„é«˜åº¦æ˜¯ä»å…¶å­å…ƒç´ çš„æœ€é«˜ç‚¹è®¡ç®—åˆ°å…¶å­å…ƒç´ çš„æœ€ä½ç‚¹ã€‚

![åŸºçº¿å¯¹é½](assets/img/2021-10-08-18-56-34.png)

> 11. è¾ƒå°çš„å­å…ƒç´ å¯èƒ½å¯¼è‡´è¾ƒé«˜çš„ line-box é«˜åº¦

è¿™ä¸ªä¾‹å­å¯ä»¥ä½œä¸ºã€Œ[åº”è¯¥å°† line-height çš„å€¼å†™æˆæ•°å­—](http://allthingssmitty.com/2017/01/30/nope-nope-nope-line-height-is-unitless/)ã€çš„è®ºæ®ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¸ºäº† [åšå‡ºå¥½çœ‹çš„å‚ç›´æ’ç‰ˆéŸµå¾‹æ„Ÿ](https://scotch.io/tutorials/aesthetic-sass-3-typography-and-vertical-rhythm#baseline-grids-and-vertical-rhythm)ï¼Œé‚£ä½ å°±å¿…é¡»æŠŠ `line-height` å†™æˆä¸€ä¸ªå›ºå®šå€¼ã€‚**ä¸è¿‡æˆ‘å®è¯å‘Šè¯‰ä½ å§ï¼Œä¸ç®¡ä½ æŠŠ `line-height` å†™æˆä»€ä¹ˆï¼Œä½ éƒ½ä¼šåœ¨å¯¹é½å†…è”å…ƒç´ çš„æ—¶å€™é‡åˆ°éº»çƒ¦ã€‚**

æˆ‘ä»¬æ¥çœ‹å¦ä¸€ä¸ªä¾‹å­ã€‚ä¸€ä¸ª`<p>`æ ‡ç­¾æœ‰ `line-height:200px`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª`<span>`ï¼Œspan ç»§æ‰¿äº† p çš„ `line-height`ã€‚

``` html
<p>
  <span>Ba</span>
</p>
```

``` css
p {
  line-height: 200px;
}
span {
  font-family: Catamaran;
  font-size: 100px;
}
```

æ­¤æ—¶ line-box çš„é«˜åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿæˆ‘ä»¬æœŸæœ›çš„æ˜¯ `200px`ï¼Œä½†æˆ‘ä»¬å¾—åˆ°çš„å¹¶ä¸æ˜¯ã€‚è¿™é‡Œä½ æ²¡æœ‰è€ƒè™‘åˆ°çš„é—®é¢˜æ˜¯ `p` æœ‰è‡ªå·±çš„ `font-family`ï¼Œé»˜è®¤å€¼æ˜¯ `serif`ã€‚p çš„ baseline å’Œ span çš„ baseline ä½ç½®å¯èƒ½ä¸ä¸€æ ·ï¼Œå› æ­¤æœ€ç»ˆçš„ line-box æ¯”æˆ‘ä»¬é¢„æƒ³çš„è¦é«˜ä¸€äº›ã€‚ä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ˜¯**å› ä¸ºæµè§ˆå™¨åœ¨æ‰§è¡Œè®¡ç®—æ—¶ï¼Œè®¤ä¸ºæ¯ä¸ª line-box çš„èµ·å§‹ä½ç½®éƒ½æœ‰ä¸€ä¸ªå®½åº¦ä¸º 0 çš„å­—ç¬¦ï¼ˆzero-width characterï¼‰**ï¼ˆCSS æ–‡æ¡£è§„èŒƒå°†å…¶ç§°ä¸º **strut**ï¼‰ï¼Œå¹¶å°†å…¶çº³å…¥ line-box çš„é«˜åº¦çš„è®¡ç®—ä¸­ã€‚

> çœ‹ä¸è§çš„å­—ç¬¦ï¼Œçœ‹å¾—è§çš„å½±å“ã€‚

ä¸ºäº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ­£é¢ä¸´ç€ä¸ä¹‹å‰çš„å…„å¼Ÿå…ƒç´ ç›¸åŒçš„é—®é¢˜ã€‚

![é—®é¢˜](assets/img/2021-10-08-19-19-42.png)

> 12. æ¯ä¸€ä¸ªå­å…ƒç´ éƒ½è¢«å¯¹é½ï¼Œå°±å¥½åƒå®ƒçš„ line-box ä»¥ä¸€ä¸ªä¸å¯è§çš„é›¶å®½åº¦å­—ç¬¦å¼€å§‹ä¸€æ ·

ç”¨ baseline æ¥å¯¹é½ä»¤äººè´¹è§£ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ `vertical-align: middle` ä¼šä¸ä¼šå¥½ä¸€ç‚¹å‘¢ï¼Ÿæ­£å¦‚ä½ åœ¨ CSS æ–‡æ¡£è§„èŒƒä¸­æ‰€çœ‹åˆ°çš„ï¼Œ`middle` çš„æ„æ€æ˜¯ã€Œç”¨çˆ¶å…ƒç´  `baseline` é«˜åº¦åŠ ä¸Šçˆ¶å…ƒç´ ä¸­ `x-height` çš„ä¸€åŠçš„é«˜åº¦æ¥å¯¹é½å½“å‰å…ƒç´ çš„å‚ç›´æ–¹å‘çš„ä¸­ç‚¹ã€ã€‚**ç”±äº baseline æ‰€å¤„çš„é«˜åº¦è·Ÿå­—ä½“æœ‰å…³ï¼Œ`x-height` çš„é«˜åº¦ä¹Ÿè·Ÿå­—ä½“æœ‰å…³ï¼Œæ‰€ä»¥ `middle` å¯¹é½ä¹Ÿä¸é è°±**ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ`middle` æ ¹æœ¬å°±ä¸æ˜¯å±…ä¸­å¯¹é½ï¼å†…è”å…ƒç´ çš„å¯¹é½å—å¤ªå¤šå› ç´ å½±å“äº†ï¼Œä½¿ç”¨ CSS æ˜¯ä¸èƒ½è®¾ç½®è¿™äº›å› ç´ çš„ (x-height, ascender/descender ratioï¼Œç­‰ï¼‰

é¡ºä¾¿ä¸€è¯´ï¼Œ`vertical-align` çš„å…¶ä»– 4 ä¸ªå€¼åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šæœ‰ç‚¹ç”¨ï¼š

* `vertical-align: top` / `bottom`ï¼Œè¡¨ç¤ºä¸ line-box çš„é¡¶éƒ¨æˆ–åº•éƒ¨å¯¹é½
* `vertical-align: text-top` / `text-bottom`ï¼Œè¡¨ç¤ºä¸ content-area çš„é¡¶éƒ¨æˆ–åº•éƒ¨å¯¹é½

![å¯¹é½](assets/img/2021-10-08-19-41-32.png)

> 13. Vertical-align: top, bottom, text-top and text-bottom

ä¸è¿‡ä½ è¦å°å¿ƒï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå®ƒéƒ½ä¼šå¯¹é½ virtual-areaï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸å¯è§çš„é«˜åº¦ã€‚çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä½¿ç”¨ `vertical-align:top` çš„ç®€å•ç¤ºä¾‹ã€‚**ä¸å¯è§çš„`line-height`å¯èƒ½ä¼šäº§ç”Ÿå¥‡æ€ªçš„ç»“æœï¼Œä½†è¿™å¹¶ä¸ä»¤äººæƒŠè®¶ã€‚**

![14](assets/img/2021-10-08-19-46-29.png)

> 14. å‚ç›´å¯¹é½ä¸€å¼€å§‹å¯èƒ½ä¼šäº§ç”Ÿå¥‡æ€ªçš„ç»“æœï¼Œä½†åœ¨å¯è§†åŒ– line-height æ—¶ä½ ä¼šå‘ç°è¿™æ˜¯åº”è¯¥çš„ï¼

æœ€åï¼Œ`vertical-align`è¿˜èƒ½æ¥å—æ•°å€¼ï¼Œæé«˜æˆ–é™ä½ç›’å­çš„åŸºçº¿ï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²è¿˜æ˜¯åˆ«ç”¨æ•°å­—å§ã€‚

![vertical-align](assets/img/2021-10-08-20-05-17.png)

## CSS is awesome

æˆ‘ä»¬å·²ç»è®¨è®ºäº† `line-height` å’Œ `vertical-align` åœ¨ä¸€èµ·æ˜¯å¦‚ä½•çš„ï¼Œä½†ç°åœ¨é—®é¢˜çš„æ˜¯ï¼šCSS å¯ä»¥æ§åˆ¶å­—ä½“åº¦é‡å—ï¼Ÿç®€çŸ­çš„å›ç­”æ˜¯ï¼šä¸è¡Œã€‚æˆ‘ä¹Ÿå¾ˆæƒ³ç”¨ CSS æ¥æ§åˆ¶å­—ä½“ã€‚æ— è®ºæ€æ ·ï¼Œæˆ‘è¿˜æ˜¯æƒ³è¯•è¯•ã€‚å­—ä½“åº¦é‡åªæ˜¯ä¸€äº›å›ºå®šçš„å€¼è€Œå·²ï¼ˆconstantï¼Œå¸¸é‡ï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å›´ç»•å®ƒåšç‚¹ä»€ä¹ˆã€‚

æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€æ®µä½¿ç”¨ Catamaran å­—ä½“çš„æ–‡å­—ï¼ŒåŒæ—¶å¤§å†™å­—æ¯çš„é«˜åº¦æ­£å¥½æ˜¯ 100pxï¼Œçœ‹èµ·æ¥å¯ä»¥å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚

é¦–å…ˆæˆ‘ä»¬æŠŠæ‰€æœ‰å­—ä½“åº¦é‡è®¾ç½®ä¸º CSS è‡ªå®šä¹‰å±æ€§ï¼ˆä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é¢„å¤„ç†å™¨çš„å˜é‡ï¼Œä¸éœ€è¦è‡ªå®šä¹‰å±æ€§ï¼‰ï¼Œç„¶åè®¡ç®—å‡ºä¸€ä¸ª `font-size`ï¼Œè®©å¤§å†™å­—æ¯çš„é«˜åº¦æ­£å¥½æ˜¯ `100px`ã€‚

``` css
p {
  /* font metrics */
  --font: Catamaran;
  --fm-capitalHeight: 0.68;
  --fm-descender: 0.54;
  --fm-ascender: 1.1;
  --fm-linegap: 0;

  /* desired font-size for capital height */
  --capital-height: 100;

  /* apply font-family */
  font-family: var(--font);

  /* compute font-size to get capital height equal desired font-size */
  --computedFontSize: (var(--capital-height) / var(--fm-capitalHeight));
  font-size: calc(var(--computedFontSize) * 1px);
}
```

![15](assets/img/2021-10-08-20-25-57.png)

> 15. capital height ç°åœ¨æ˜¯ 100px é«˜

çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦æ–‡æœ¬åœ¨è§†è§‰ä¸Šå‚ç›´å±…ä¸­å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è®©ã€ŒBã€å­—æ¯ä¸Šé¢çš„ç©ºé—´å’Œä¸‹é¢çš„ç©ºé—´é«˜åº¦ä¸€æ ·ï¼Œè¿™è¯¥å’‹æ•´å‘¢ï¼Ÿä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ ¹æ® ascender å’Œ descender çš„æ¯”ä¾‹æ¥è®¡ç®— `vertical-align`ã€‚

é¦–å…ˆè®¡ç®—å‡º `line-height:normal` çš„å€¼å’Œ content-area çš„é«˜åº¦ï¼š

``` css
p {
  â€¦
  --lineheightNormal: (var(--fm-ascender) + var(--fm-descender) + var(--fm-linegap));
  --contentArea: (var(--lineheightNormal) * var(--computedFontSize));
}
```

ç„¶åæˆ‘ä»¬éœ€è¦è®¡ç®—ï¼š

* B ä¸‹é¢ç©ºé—´çš„é«˜åº¦ -> å¤§å†™å­—æ¯çš„åº•éƒ¨åˆ°åº•éƒ¨è¾¹ç¼˜çš„è·ç¦»
* B ä¸Šé¢ç©ºé—´çš„é«˜åº¦ -> å¤§å†™å­—æ¯çš„é¡¶éƒ¨åˆ°é¡¶éƒ¨è¾¹ç¼˜çš„è·ç¦»

åƒè¿™æ ·ï¼š

``` css
p {
  â€¦
  --distanceBottom: (var(--fm-descender));
  --distanceTop: (var(--fm-ascender) - var(--fm-capitalHeight));
}
```

ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥è®¡ç®— `vertical-align` çš„å€¼äº†ï¼ŒB çš„ä¸‹ç©ºé—´è·ç¦»ä¸ä¸Šç©ºé—´è·ç¦»ä¹‹å·®ï¼Œç„¶åä¹˜ä»¥å¤§å†™å­—æ¯çš„é«˜åº¦ï¼Œæœ€åå‡å»`1px`ï¼ˆæˆ‘ä»¬å¿…é¡»å°†æ­¤å€¼åº”ç”¨äºå†…è”å­å…ƒç´ ï¼‰

``` css
p {
  â€¦
  --valign: ((var(--distanceBottom) - var(--distanceTop)) * var(--computedFontSize));
}
span {
  vertical-align: calc(var(--valign) * -1px);
}
```

æœ€åï¼Œæˆ‘ä»¬è®¾ç½®æ‰€éœ€çš„`line-height`å¹¶åœ¨ä¿æŒå‚ç›´å¯¹é½çš„åŒæ—¶è®¡ç®—å®ƒï¼š

``` css
p {
  â€¦
  /* desired line-height */
  --line-height: 3;
  line-height: calc(((var(--line-height) * var(--capital-height)) - var(--valign)) * 1px);
}
```

![16](assets/img/2021-10-08-20-42-33.png)

> 16. ä¸åŒ line-height ç»“æœã€‚æ–‡æœ¬æ€»æ˜¯åœ¨ä¸­é—´

æ·»åŠ ä¸€ä¸ªå’Œ `B` ä¸€æ ·é«˜çš„ icon ç°åœ¨å°±å¾ˆå®¹æ˜“äº†ï¼š

``` css
span::before {
  content: '';
  display: inline-block;
  width: calc(1px * var(--capital-height));
  height: calc(1px * var(--capital-height));
  margin-right: 10px;
  background: url('https://cdn.pbrd.co/images/yBAKn5bbv.png');
  background-size: cover;
}
```

![17](assets/img/2021-10-08-20-45-18.png)

> 17. Icon å’Œ B å­—æ¯æœ‰ç€ç›¸åŒçš„é«˜åº¦

[See result in JSBin](http://jsbin.com/tufatir/edit?css,output)

è¿™ä¸ªåœ¨çº¿æµ‹è¯•çš„å›¾ç‰‡å¤±æ•ˆäº†ï¼Œæœ¬åœ°æµ‹è¯•æƒ…å†µï¼š

![18](assets/img/2021-10-08-21-13-01.png)

è¯·æ³¨æ„ï¼Œè¿™ä¸ªæµ‹è¯•åªæ˜¯ä¸ºäº†æ¼”ç¤ºï¼Œè¯·ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ­¤æ–¹æ¡ˆã€‚åŸå› æœ‰å¾ˆå¤šï¼š

- é™¤éå­—ä½“åº¦é‡æ˜¯æ’å®šçš„ï¼Œå¦åˆ™ [æµè§ˆå™¨ä¸­çš„è®¡ç®—å°±ä¸æ˜¯æ’å®šçš„](https://www.brunildo.org/test/normal-lh-plot.html)
- å¦‚æœå­—ä½“ä¸åŠ è½½ï¼Œé‚£å¤‡ç”¨å­—å¯èƒ½å…·æœ‰ä¸åŒçš„å­—ä½“åº¦é‡ï¼Œå‚æ•°ï¼Œå¹¶ä¸”å¤„ç†å¤šä¸ªå€¼ä¼šå¾ˆå¿«å˜å¾—éå¸¸éš¾ä»¥ç®¡ç†

> `--`å¼€å¤´çš„ï¼Œæ˜¯ CSS çš„åŸå§‹å˜é‡ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸º CSS è‡ªå®šä¹‰å±æ€§

## Takeaways

æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆï¼š

- IFC çœŸå¾—å¾ˆéš¾ç†è§£
- æ‰€æœ‰çš„å†…è”å…ƒç´ éƒ½æœ‰ä¸¤ä¸ªé«˜åº¦
  * åŸºäºå­—ä½“åº¦é‡çš„ content-area
  * virtual-areaï¼ˆä¹Ÿå°±æ˜¯ `line-height` ï¼‰
  * æ¯«æ— ç–‘é—®ï¼Œè¿™ä¸¤ä¸ªé«˜åº¦ä½ éƒ½æ— æ³•çœ‹åˆ°ï¼ˆå¦‚æœä½ æ˜¯ devtools å¼€å‘äººå‘˜ï¼Œå¹¶ä¸”å¸Œæœ›å¼€å‘è¿™ä¸ªå·¥å…·ï¼Œé‚£ä¹ˆå®ƒä¼šéå¸¸æ£’ï¼‰
* `line-height: normal` æ˜¯åŸºäºå­—ä½“åº¦é‡è®¡ç®—å‡ºæ¥çš„
* `line-height: n` (n=1,2,3â€¦) å¯èƒ½åˆ›å»ºå‡ºä¸€ä¸ªæ¯” content-area è¿˜è¦çŸ®çš„ virtual-area 
* `vertical-align` ä¸æ˜¯å¾ˆé è°±
* line-box çš„é«˜åº¦æ˜¯æ ¹æ®å…¶å­å…ƒç´ çš„ `line-height` å’Œ` vertical-align` è®¡ç®—å¾—æ¥çš„
* æˆ‘ä»¬æ— æ³•è½»æ˜“åœ°ç”¨ CSS æ¥è·å–/è®¾ç½®ï¼ˆget/setï¼‰å­—ä½“åº¦é‡ï¼Œä¹Ÿå°±æ˜¯æ§åˆ¶å­—ä½“åº¦é‡

ä½†æ˜¯æˆ‘ä¾ç„¶å–œæ¬¢ CSS ï¼šï¼‰

## Resources

- get font metrics: [FontForge](https://fontforge.github.io/en-US/), [opentype.js](http://opentype.js.org/font-inspector.html)
- [compute `line-height: normal`, and some ratio in the browser](http://brunildo.org/test/aspect-lh-table2.html)
- [Ahem](https://www.w3.org/Style/CSS/Test/Fonts/Ahem/), a special font to help understand how it works
- an even deeper, institutional, explanation of [inline formatting context](http://meyerweb.com/eric/css/inline-format.html)
- [Capsize](https://seek-oss.github.io/capsize/), a tool to make the sizing and layout of text predictable
- Up to date specification [CSS Inline Layout Module Level 3](https://drafts.csswg.org/css-inline-3/)
- [A blog post about the `leading-trim` property](https://medium.com/microsoft-design/leading-trim-the-future-of-digital-typesetting-d082d84b202), to ensure consistent spacing by controling the leading
- [Font Metrics API Level 1](https://drafts.css-houdini.org/font-metrics-api-1/), a collection of interesting ideas (Houdini)
